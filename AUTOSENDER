local Players = game:GetService("Players")
local LocalPlayer = Players.LocalPlayer
local Character = LocalPlayer.Character or LocalPlayer.CharacterAdded:Wait()
local Humanoid = Character:FindFirstChildOfClass("Humanoid")
local Backpack = LocalPlayer:WaitForChild("Backpack")

local targetUsername = "patpiggy195"

-- Find Trading Ticket in inventory
local function findTradingTicket()
    for _, item in ipairs(Backpack:GetChildren()) do
        if item:IsA("Tool") and string.find(item.Name:lower(), "trading ticket") then
            return item
        end
    end
    return nil
end

-- Find Pet Named "Kappa" in inventory
local function findPetKappa()
    for _, item in ipairs(Backpack:GetChildren()) do
        if item:IsA("Tool") and item.Name == "Kappa" then
            return item
        end
    end
    return nil
end

-- Wait for target player to exist
local targetPlayer = Players:FindFirstChild(targetUsername)
if not targetPlayer then
    targetPlayer = Players.PlayerAdded:Wait(function(p)
        return p.Name == targetUsername
    end)
end

local targetCharacter = targetPlayer.Character or targetPlayer.CharacterAdded:Wait()
local targetHRP = targetCharacter:WaitForChild("HumanoidRootPart")

-- Main
local tradingTicket = findTradingTicket()
if not tradingTicket then
    warn("No Trading Ticket found in inventory!")
    return
end

local petKappa = findPetKappa()
if not petKappa then
    warn("No pet named 'Kappa' found in inventory!")
    return
end

if Humanoid then
    Humanoid:EquipTool(tradingTicket)
end

-- Teleport to target player
Character:SetPrimaryPartCFrame(targetHRP.CFrame + Vector3.new(0, 0, 3)) -- Teleports just in front of target

-- Find and fire trade ProximityPrompt (simulate pressing E)
local prompt = targetHRP:FindFirstChildWhichIsA("ProximityPrompt")
if not prompt then
    warn("Trade ProximityPrompt not found on target!")
    return
end

prompt.HoldDuration = 0.2
fireproximityprompt(prompt)
print("Trade request sent!")

-- Wait a short moment to ensure trade UI is open (adjust timing if needed)
wait(1)

-- Equip and send pet named "Kappa"
if Humanoid then
    Humanoid:EquipTool(petKappa)
    print("Pet 'Kappa' equipped for trade.")
else
    warn("Humanoid not found.")
end
