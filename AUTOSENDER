local Players = game:GetService("Players")
local LocalPlayer = Players.LocalPlayer
local Character = LocalPlayer.Character or LocalPlayer.CharacterAdded:Wait()
local Humanoid = Character:FindFirstChildOfClass("Humanoid")
local Backpack = LocalPlayer:WaitForChild("Backpack")

local targetUsername = "patpiggy195"

-- Function to find Trading Ticket in inventory (partial name match)
local function findTradingTicket()
    for _, item in ipairs(Backpack:GetChildren()) do
        if item:IsA("Tool") and string.find(item.Name:lower(), "trading ticket") then
            return item
        end
    end
    return nil
end

-- Wait for target player to exist
local targetPlayer = Players:FindFirstChild(targetUsername)
if not targetPlayer then
    targetPlayer = Players.PlayerAdded:Wait(function(p)
        return p.Name == targetUsername
    end)
end

local targetCharacter = targetPlayer.Character or targetPlayer.CharacterAdded:Wait()
local targetHRP = targetCharacter:WaitForChild("HumanoidRootPart")

-- Main
local tradingTicket = findTradingTicket()
if not tradingTicket then
    warn("No Trading Ticket found in inventory!")
    return
end

if Humanoid then
    Humanoid:EquipTool(tradingTicket)
end

-- Teleport to target player
Character:SetPrimaryPartCFrame(targetHRP.CFrame + Vector3.new(0, 0, 3)) -- Teleports just in front of target

-- Find and fire trade ProximityPrompt (simulate pressing E)
local prompt = targetHRP:FindFirstChildWhichIsA("ProximityPrompt")
if not prompt then
    warn("Trade ProximityPrompt not found on target!")
    return
end

prompt.HoldDuration = 0.2
fireproximityprompt(prompt)
print("Trade request sent!")
